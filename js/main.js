const app = new Vue({
    el: '#root',
    data: {
        contacts: [
            {
                name: 'Michele',
                avatar: '_1',
                visible: true,
                messages: [
                    {
                        date: '10/01/2020 15:30:55',
                        message: 'Hai portato a spasso il cane?',
                        status: 'sent',
                    },
                    {
                        date: '10/01/2020 15:50:00',
                        message: 'Ricordati di dargli da mangiare',
                        status: 'sent'

                    },
                    {
                        date: '10/01/2020 16:15:22',
                        message: 'Tutto fatto!',
                        status: 'received'

                    }
                ],
            },
            {
                name: 'Fabio',
                avatar: '_2',
                visible: true,
                messages: [{
                    date: '20/03/2020 16:30:00',
                    message: 'Ciao come stai?',
                    status: 'sent'
                },
                {
                    date: '20/03/2020 16:30:55',
                    message: 'Bene grazie! Stasera ci vediamo?',
                    status: 'received'
                },
                {
                    date: '20/03/2020 16:35:00',
                    message: 'Mi piacerebbe ma devo andare a fare la spesa.',
                    status: 'received'
                }
                ],
            },
            {
                name: 'Samuele',
                avatar: '_3',
                visible: true,
                messages: [{
                    date: '28/03/2020 10:10:40',
                    message: 'La Marianna va in campagna',
                    status: 'received'
                },
                {
                    date: '28/03/2020 10:20:10',
                    message: 'Sicuro di non aver sbagliato chat?',
                    status: 'sent'
                },
                {
                    date: '28/03/2020 16:15:22',
                    message: 'Ah scusa!',
                    status: 'received'
                }
                ],
            },
            {
                name: 'Luisa',
                avatar: '_4',
                visible: true,
                messages: [{
                    date: '10/01/2020 15:30:55',
                    message: 'Lo sai che ha aperto una nuova pizzeria?',
                    status: 'sent'
                },
                {
                    date: '10/01/2020 15:50:00',
                    message: 'Si, ma preferirei andare al cinema',
                    status: 'received'
                }
                ],
            },
        ],
        emoji: ["ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„","ðŸ˜","ðŸ˜†", "ðŸ˜…", "ðŸ¤£","ðŸ˜‚","ðŸ™‚","ðŸ™ƒ","ðŸ˜‰","ðŸ˜Š","ðŸ˜‡","ðŸ¥°","ðŸ˜","ðŸ¤©","ðŸ˜˜","ðŸ˜—","ðŸ˜š","ðŸ˜™","ðŸ˜‹","ðŸ˜›","ðŸ˜œ","ðŸ¤ª","ðŸ˜","ðŸ¤‘","ðŸ¤—","ðŸ¤­","ðŸ¤«","ðŸ¤”","ðŸ¤","ðŸ¤¨","ðŸ˜","ðŸ˜‘","ðŸ˜¶","ðŸ˜","ðŸ˜’","ðŸ™„","ðŸ˜¬","ðŸ¤¥","ðŸ˜Œ","ðŸ˜”","ðŸ˜ª","ðŸ¤¤","ðŸ˜´","ðŸ˜·","ðŸ¤’","ðŸ¤•","ðŸ¤¢","ðŸ¤®","ðŸ¤§","ðŸ¥µ","ðŸ¥¶","ðŸ¥´","ðŸ˜µ","ðŸ¤¯","ðŸ¤ ","ðŸ¥³","ðŸ˜Ž","ðŸ¤“","ðŸ§","ðŸ˜•","ðŸ˜Ÿ","ðŸ™","â˜¹ï¸","ðŸ˜®","ðŸ˜¯","ðŸ˜²","ðŸ˜³","ðŸ¥º","ðŸ˜¦","ðŸ˜§","ðŸ˜¨","ðŸ˜°","ðŸ˜¥","ðŸ˜¢","ðŸ˜­","ðŸ˜±","ðŸ˜–","ðŸ˜£","ðŸ˜ž","ðŸ˜“","ðŸ˜©","ðŸ˜«","ðŸ¥±","ðŸ˜¤","ðŸ˜¡","ðŸ˜ ","ðŸ¤¬","ðŸ˜ˆ","ðŸ‘¿","ðŸ’€","â˜ ï¸","ðŸ’©","ðŸ¤¡","ðŸ‘¹","ðŸ‘º","ðŸ‘»","ðŸ‘½","ðŸ‘¾","ðŸ¤–","ðŸ˜º","ðŸ˜¸","ðŸ˜¹","ðŸ˜»","ðŸ˜¼","ðŸ˜½","ðŸ™€","ðŸ˜¿","ðŸ˜¾","ðŸ™ˆ","ðŸ™‰","ðŸ™Š","ðŸ’‹","ðŸ’Œ","ðŸ’˜","ðŸ’","ðŸ’–","ðŸ’—","ðŸ’“","ðŸ’ž","ðŸ’•","ðŸ’Ÿ","â£ï¸","ðŸ’”","â¤ï¸","ðŸ§¡","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","ðŸ¤Ž","ðŸ–¤","ðŸ¤","ðŸ’¯","ðŸ’¢","ðŸ’¥","ðŸ’«","ðŸ’¦","ðŸ’¨","ðŸ•³ï¸","ðŸ’£","ðŸ’¬","ðŸ‘ï¸â€ðŸ—¨ï¸","ðŸ—¨ï¸","ðŸ—¯ï¸","ðŸ’­","ðŸ’¤"	,"ðŸ‘‹","ðŸ¤š","ðŸ–ï¸","âœ‹","ðŸ––","ðŸ‘Œ","ðŸ¤","âœŒï¸","ðŸ¤ž","ðŸ¤Ÿ","ðŸ¤˜","ðŸ¤™","ðŸ‘ˆ","ðŸ‘‰","ðŸ‘†","ðŸ–•","ðŸ‘‡","â˜ï¸","ðŸ‘","ðŸ‘Ž","âœŠ","ðŸ‘Š","ðŸ¤›","ðŸ¤œ","ðŸ‘","ðŸ™Œ","ðŸ‘","ðŸ¤²","ðŸ¤","ðŸ™","âœï¸","ðŸ’…","ðŸ¤³","ðŸ’ª","ðŸ¦¾","ðŸ¦¿","ðŸ¦µ","ðŸ¦¶","ðŸ‘‚","ðŸ¦»","ðŸ‘ƒ","ðŸ§ ","ðŸ¦·","ðŸ¦´","ðŸ‘€","ðŸ‘ï¸","ðŸ‘…","ðŸ‘„","ðŸ‘¶","ðŸ§’","ðŸ‘¦","ðŸ‘§","ðŸ§‘","ðŸ‘±","ðŸ‘¨","ðŸ‘¨â€ðŸ¦°","ðŸ‘¨â€ðŸ¦±","ðŸ‘¨â€ðŸ¦³","ðŸ‘¨â€ðŸ¦²","ðŸ‘©","ðŸ‘©â€ðŸ¦°","ðŸ‘±â€â™‚ï¸","ðŸ§“","ðŸ‘´","ðŸ‘µ","ðŸ™","ðŸ™â€â™‚ï¸","ðŸ™â€â™€ï¸","ðŸ™Ž","ðŸ™Žâ€â™‚ï¸","ðŸ™Žâ€â™€ï¸","ðŸ™…","ðŸ™…â€â™‚ï¸","ðŸ™…â€â™€ï¸","ðŸ™†","ðŸ™†â€â™‚ï¸","ðŸ™†â€â™€ï¸","ðŸ’","ðŸ’â€â™‚ï¸","ðŸ’â€â™€ï¸","ðŸ™‹","ðŸ™‹â€â™‚ï¸","ðŸ™‹â€â™€ï¸","ðŸ§","ðŸ§â€â™‚ï¸","ðŸ§â€â™€ï¸","ðŸ™‡","ðŸ™‡â€â™‚ï¸","ðŸ™‡â€â™€ï¸","ðŸ¤¦","ðŸ¤¦â€â™‚ï¸","ðŸ¤¦â€â™€ï¸","ðŸ¤·","ðŸ¤·â€â™‚ï¸","ðŸ‘¨â€âš•ï¸","ðŸ‘©â€âš•ï¸","ðŸ‘¨â€ðŸŽ“","ðŸ‘©â€ðŸŽ“","ðŸ‘¨â€ðŸ«","ðŸ‘©â€ðŸ«","ðŸ‘¨â€âš–ï¸","ðŸ‘©â€âš–ï¸","ðŸ‘¨â€ðŸŒ¾","ðŸ‘©â€ðŸŒ¾","ðŸ‘¨â€ðŸ³","ðŸ‘©â€ðŸ³","ðŸ‘¨â€ðŸ”§","ðŸ‘©â€ðŸ”§","ðŸ‘¨â€ðŸ­","ðŸ‘©â€ðŸ­","ðŸ‘¨","ðŸ‘©â€ðŸ’¼","ðŸ‘¨â€ðŸ”¬","ðŸ‘©â€ðŸ”¬","ðŸ‘¨â€ðŸ’»","ðŸ‘©â€ðŸ’»","ðŸ‘¨â€ðŸŽ¤","ðŸ‘©â€ðŸŽ¤","ðŸ‘¨â€ðŸŽ¨","ðŸ‘©â€ðŸŽ¨","ðŸ‘¨â€âœˆï¸","ðŸ‘©â€âœˆï¸","ðŸ‘¨â€ðŸš€","ðŸ‘©â€ðŸš€","ðŸ‘¨â€ðŸš’","ðŸ‘©â€ðŸš’","ðŸ‘®","ðŸ‘®â€â™€ï¸","ðŸ•µï¸","ðŸ•µï¸â€â™€ï¸","ðŸ’‚â€â™‚ï¸","ðŸ’‚â€â™€ï¸","ðŸ‘·â€â™‚ï¸","ðŸ‘·â€â™€ï¸","ðŸ¤´","ðŸ‘¸","ðŸ‘³â€â™‚ï¸","ðŸ‘³â€â™€ï¸","ðŸ‘²","ðŸ§•","ðŸ¤µ","ðŸ‘°","ðŸ¤°","ðŸ¤±","ðŸ‘¼","ðŸŽ…","ðŸ¤¶","ðŸ¦¸â€â™‚ï¸","ðŸ¦¸â€â™€ï¸","ðŸ¦¹â€â™‚ï¸","ðŸ¦¹â€â™€ï¸","ðŸ§™â€â™‚ï¸","ðŸ§™â€â™€ï¸","ðŸ§šâ€â™‚ï¸","ðŸ§šâ€â™€ï¸","ðŸ§›â€â™‚ï¸","ðŸ§›â€â™€ï¸","ðŸ§œâ€â™‚ï¸","ðŸ§œâ€â™€ï¸","ðŸ§â€â™‚ï¸","ðŸ§â€â™€ï¸","ðŸ§žâ€â™‚ï¸","ðŸ§žâ€â™€ï¸","ðŸ§Ÿâ€â™‚ï¸","ðŸ§Ÿâ€â™€ï¸","ðŸ’†â€â™‚ï¸","ðŸ’†â€â™€ï¸","ðŸ’‡â€â™‚ï¸","ðŸ’‡â€â™€ï¸","ðŸš¶â€â™‚ï¸","ðŸš¶â€â™€ï¸","ðŸ§â€â™‚ï¸","ðŸ§â€â™€ï¸","ðŸ§Žâ€â™‚ï¸","ðŸ§Žâ€â™€ï¸","ðŸ‘¨â€ðŸ¦¯","ðŸ‘©â€ðŸ¦¯","ðŸ‘¨â€ðŸ¦¼","ðŸ‘©â€ðŸ¦¼","ðŸ‘¨â€ðŸ¦½","ðŸ‘©â€ðŸ¦½","ðŸƒâ€â™‚ï¸","ðŸƒâ€â™€ï¸","ðŸ’ƒ","ðŸ•º","ðŸ•´ï¸","ðŸ‘¯â€â™‚ï¸","ðŸ‘¯â€â™€ï¸","ðŸ§–â€â™‚ï¸","ðŸ§–â€â™€ï¸","ðŸ§—â€â™‚ï¸","ðŸ§—â€â™€ï¸","ðŸ¤º","ðŸ‡","â›·ï¸","ðŸ‚","ðŸŒï¸â€â™‚ï¸","ðŸŒï¸â€â™€ï¸","ðŸ„â€â™‚ï¸","ðŸ„â€â™€ï¸","ðŸš£â€â™‚ï¸","ðŸš£â€â™€ï¸","ðŸŠâ€â™‚ï¸","ðŸŠâ€â™€ï¸","â›¹ï¸â€â™‚ï¸","â›¹ï¸â€â™€ï¸","ðŸ‹ï¸â€â™‚ï¸","ðŸ‹ï¸â€â™€ï¸","ðŸš´â€â™‚ï¸","ðŸš´â€â™€ï¸","ðŸšµâ€â™‚ï¸","ðŸšµâ€â™€ï¸","ðŸ¤¸â€â™‚ï¸","ðŸ¤¸â€â™€ï¸","ðŸ¤¼â€â™‚ï¸","ðŸ¤¼â€â™€ï¸","ðŸ¤½â€â™‚ï¸","ðŸ¤½â€â™€ï¸","ðŸ¤¾â€â™‚ï¸","ðŸ¤¾â€â™€ï¸","ðŸ¤¹â€â™‚ï¸","ðŸ¤¹â€â™€ï¸","ðŸ§˜â€â™‚ï¸","ðŸ§˜â€â™€ï¸","ðŸ›€","ðŸ›Œ","ðŸ§‘â€ðŸ¤â€ðŸ§‘","ðŸ‘­","ðŸ‘«","ðŸ‘¬","ðŸ’","ðŸ‘©â€â¤ï¸â€ðŸ’‹â€ðŸ‘¨","ðŸ‘¨â€â¤ï¸â€ðŸ’‹â€ðŸ‘¨","ðŸ‘©â€â¤ï¸â€ðŸ’‹â€ðŸ‘©","ðŸ’‘","ðŸ‘©â€â¤ï¸â€ðŸ‘¨","ðŸ‘¨â€â¤ï¸â€ðŸ‘¨","ðŸ‘©â€â¤ï¸â€ðŸ‘©","ðŸ‘ª","ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘©â€ðŸ‘§","ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘¨â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘¨â€ðŸ‘§â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘¨â€ðŸ‘§â€ðŸ‘§","ðŸ‘©â€ðŸ‘©â€ðŸ‘¦","ðŸ‘©â€ðŸ‘©â€ðŸ‘§","ðŸ‘©â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦","ðŸ‘©â€ðŸ‘©â€ðŸ‘§â€ðŸ‘§","ðŸ‘¨â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘¦â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘§","ðŸ‘¨â€ðŸ‘§â€ðŸ‘¦","ðŸ‘¨â€ðŸ‘§â€ðŸ‘§","ðŸ‘©â€ðŸ‘¦","ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦","ðŸ‘©â€ðŸ‘§","ðŸ‘©â€ðŸ‘§â€ðŸ‘¦","ðŸ‘©â€ðŸ‘§â€ðŸ‘§","ðŸ—£ï¸","ðŸ‘¤","ðŸ‘¥","ðŸ‘£"],
        emojiList: [],
        activeChatIndex: 0,
        typedMsg: "",
        searchInput: "",
        componentKey: 0,
        audioIN: { audio: true },
        voiceNotes: [],
        recorder: 0,
        click: false,
        emojiclick: false
    },
    methods: {
        currentDate: function () {
            const d = new Date();
            const date = `${d.getDate().toString().padStart(2, "0")}/${(d.getMonth() + 1).toString().padStart(2, "0")}/${d.getFullYear()}`;
            const time = `${d.getHours()}:${d.getMinutes().toString().padStart(2, "0")}:${d.getSeconds().toString().padStart(2, "0")}`;
            return `${date} ${time}`;
        },
        assignInputValue: function () {
            const lines = this.typedMsg.split("\n").filter(e => e !== "" && e !== " ");
            if (lines.length !== 0) {
                // print input obj
                this.contacts[this.activeChatIndex].messages.push({
                    date: this.currentDate(),
                    message: this.typedMsg,
                    status: 'sent',
                    menu: 'hide'
                });
                // reset input
                this.typedMsg = "";
                setTimeout(() => {
                    // print cpu obj
                    this.contacts[this.activeChatIndex].messages.push({
                        date: this.currentDate(),
                        message: 'Ok',
                        status: 'received',
                        menu: 'hide'
                    })
                }, 1000);
            }
        },
        searchIn: function () {
            return this.contacts.filter(e => e.name.toLowerCase().includes(this.searchInput.toLowerCase()))
        },
        forceRerender() {
            this.componentKey += 1;
            OverlayScrollbars(document.getElementById(''), { /* your options */ })
        },
        deleteMsg: function (msgIndex) {
            var n = this.contacts[this.activeChatIndex].messages;
            n.splice(msgIndex, 1);
            n[msgIndex].menu = 'hide';
            this.forceRerender()
        },
        voiceNote: function () {
            if (this.click == false) {
                let device = navigator.mediaDevices.getUserMedia(this.audioIN);
                device.then(stream => {
                    this.recorder = new MediaRecorder(stream);
                    this.recorder.ondataavailable = e => {
                        this.voiceNotes.push(e.data);
                        if (this.recorder.state == 'inactive') {
                            var blob = new Blob(this.voiceNotes, { type: 'audio/webm' });
                            this.contacts[this.activeChatIndex].messages.push({
                                date: this.currentDate(),
                                message: null,
                                status: 'sent',
                                menu: 'hide',
                                src: `${URL.createObjectURL(blob)}`
                            });
                        }
                    }
                    console.log(this.voiceNotes)
                    this.recorder.start();
                })
            } else {
                this.recorder.stop();
            }
        }
    },
    created() {
        this.contacts.forEach(e => {
            e.messages.forEach((el) => el.menu = 'hide')
        });
        this.emoji.forEach((e) => this.emojiList.push(
            {icon: e}
        ));
        console.log(this.emojiList)
    },

});
